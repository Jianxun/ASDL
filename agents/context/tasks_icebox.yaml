schema_version: 1

icebox:
  - id: T-052
    title: Backend lowering refactor
    owner: Executor
    dod: >
      Refactor backend lowering to separate verification from
      rendering/emission; reduce overly defensive checks in render paths now
      covered by verification. Focus on readability and single-pass flow
      without changing netlist output or diagnostics semantics.
    verify:
      - pytest tests/unit_tests/emit -v
      - pytest tests/unit_tests/netlist -v
    links:
      scratchpad: agents/scratchpads/T-052_backend_lowering_refactor.md
  - id: T-056
    title: Exports sugar
    owner: Executor
    dod: >
      Add `exports` sugar to AST and lowering: allow `exports` block in modules
      and forward child ports into parent nets per `docs/specs/spec_ast.md`.
      Include diagnostics for invalid forwarding; no changes to IFIR
      semantics beyond expanded nets.
    verify:
      - pytest tests/unit_tests/ast -v
      - pytest tests/unit_tests/ir -v
    links:
      scratchpad: agents/scratchpads/T-056_exports_sugar.md
  - id: T-104
    title: Pipeline IR dump hooks
    owner: Executor
    dod: >
      Add debug options to the MVP pipeline to dump NFIR/IFIR/atomized IFIR
      modules to text for inspection. Support selecting stages and directing
      output to a dump directory or callback; ensure dumps are emitted even when
      verify is disabled. Add unit tests that run the pipeline on a small fixture
      and assert the dump outputs exist and include expected op headers.
    verify:
      - pytest tests/unit_tests/e2e/test_pipeline_mvp.py -v
    links:
      scratchpad: agents/scratchpads/T-104_pipeline_ir_dump_hooks.md
  - id: T-105
    title: CLI IR dump options
    owner: Executor
    dod: >
      Add asdlc netlist flags to dump NFIR/IFIR/atomized IFIR to disk
      (for example, --dump-ir nfir,ifir,atom and --dump-dir). Use pipeline
      debug hooks to emit dumps next to the output file by default. Update CLI
      help text and document file naming conventions.
    verify:
      - pytest tests/unit_tests/e2e/test_pipeline_mvp.py -v
    links:
      scratchpad: agents/scratchpads/T-105_cli_ir_dump_options.md
  - id: T-106
    title: Preserve AST location spans
    owner: Executor
    dod: >
      Preserve detailed AST locations for downstream diagnostics by retaining a
      LocationIndex (or equivalent lookup helper) on the parsed document and
      exposing key spans for module/device/patterns/instance_defaults entries.
      Add unit tests that assert key and list-item spans for a fixture covering
      modules, devices, patterns, instance_defaults, nets, and instances.
    verify:
      - pytest tests/unit_tests/ast -v
    files:
      - src/asdl/ast/parser.py
      - src/asdl/ast/models.py
      - src/asdl/ast/location.py
      - tests/unit_tests/ast/test_locations.py
    links:
      scratchpad: agents/scratchpads/T-106_ast_location_spans.md
  - id: T-107
    title: Add minimal AST token validation
    owner: Executor
    dod: >
      Add minimal AST validation for endpoint tokens and instance expressions:
      endpoint strings must contain exactly one '.' with non-empty instance and
      pin segments and no whitespace; instance expressions must include a model
      token and optional key=value tokens with non-empty key/value segments.
      Extend parser/AST tests to cover invalid tokens with precise diagnostics.
    verify:
      - pytest tests/unit_tests/parser -v
    files:
      - src/asdl/ast/models.py
      - src/asdl/ast/parser.py
      - tests/unit_tests/parser/test_ast_validation.py
    links:
      scratchpad: agents/scratchpads/T-107_ast_token_validation.md
  - id: T-120
    title: Pattern subsystem package split
    owner: Executor
    dod: >
      Replace the monolithic patterns module with a `src/asdl/patterns/` package
      that separates tokenization, expansion, atomization, and diagnostics while
      preserving the public API (`expand_pattern`, `expand_endpoint`,
      `atomize_pattern`, `atomize_endpoint`) and existing behavior. Update
      imports and keep diagnostics codes unchanged.
    verify:
      - venv/bin/pytest tests/unit_tests/parser/test_pattern_expansion.py tests/unit_tests/parser/test_pattern_atomization.py -v
    files:
      - src/asdl/patterns.py
      - src/asdl/patterns/__init__.py
      - src/asdl/patterns/atomize.py
      - src/asdl/patterns/expand.py
      - src/asdl/patterns/tokenize.py
    links:
      scratchpad: agents/scratchpads/T-120_pattern_package_split.md
  - id: T-121
    title: Centralize pattern binding verification helpers
    owner: Executor
    dod: >
      Introduce shared helpers for pattern binding/length/collision checks and
      reuse them in NFIR verification and NFIR->IFIR conversion. Keep existing
      diagnostics codes and VerifyException text stable; behavior remains
      unchanged.
    verify:
      - venv/bin/pytest tests/unit_tests/ir/test_ifir_converter.py tests/unit_tests/ir/test_pattern_atomization.py -v
    files:
      - src/asdl/ir/nfir/dialect.py
      - src/asdl/ir/converters/nfir_to_ifir.py
      - src/asdl/patterns/verify.py
      - tests/unit_tests/ir/test_pattern_atomization.py
    links:
      scratchpad: agents/scratchpads/T-121_pattern_verification_helpers.md
  - id: T-122
    title: Consolidate GraphIR rebundling utilities
    owner: Executor
    dod: >
      Keep GraphIR rebundling helpers in `src/asdl/ir/graphir/patterns.py` only
      and remove wrapper exports from pattern passes. Update call sites and
      ensure tests continue to exercise rebundling behavior.
    verify:
      - venv/bin/pytest tests/unit_tests/ir/test_pattern_atomization.py -v
    files:
      - src/asdl/ir/graphir/patterns.py
      - src/asdl/ir/pattern_atomization.py
      - src/asdl/ir/pattern_elaboration.py
    links:
      scratchpad: agents/scratchpads/T-122_graphir_rebundling_cleanup.md
  - id: T-123
    title: Pattern tests and docs cleanup
    owner: Executor
    dod: >
      Reorganize pattern tests into a focused suite (parser + IR integration),
      add a short doc note describing atomized-only IFIR expectations for
      emission, and remove stale references to the deprecated elaboration pass.
    verify:
      - venv/bin/pytest tests/unit_tests/parser/test_pattern_expansion.py tests/unit_tests/parser/test_pattern_atomization.py tests/unit_tests/ir/test_pattern_atomization.py -v
    files:
      - tests/unit_tests/parser/test_pattern_expansion.py
      - tests/unit_tests/parser/test_pattern_atomization.py
      - tests/unit_tests/ir/test_pattern_atomization.py
      - docs/outstanding_topics.md
      - agents/context/contract.md
    links:
      scratchpad: agents/scratchpads/T-123_pattern_tests_docs_cleanup.md
