# Tasks

## Active OKR(s)
- MVP net-first stack skeleton: ASDL_A → ASDL_NFIR → ASDL_CIR → ASDL_NLIR_U/E (`asdl_nlir`) → emit.

## Current Sprint
- T-020 | Status: Done | Owner: Executor | DoD: Rename core xDSL dialect to `asdl_cir` in code/tests; update converter usage and IR text expectations to match ASDL_CIR naming; keep semantics unchanged. | Verify: `pytest tests/unit_tests/ir`. | Links: scratchpad `agents/scratchpads/T-020_cir_rename.md`, PR https://github.com/Jianxun/ASDL/pull/24.
- T-021 | Status: Ready | Owner: Executor | DoD: Rewrite ASDL_A (Tier-1) AST + parser for net-first explicit schema (explicit instances/nets only; no pattern sugar/imports/exports/inline binds); ports inferred only from `$` net keys; add parser/AST tests for MVP constraints. | Verify: `pytest tests/unit_tests/parser`. | Links: scratchpad `agents/scratchpads/T-021_ast_net_first_mvp.md`.
- T-022 | Status: Ready | Owner: Executor | DoD: Implement ASDL_NFIR dialect + AST→NFIR converter for MVP explicit nets/instances; endpoints are explicit; add NFIR dialect tests. | Verify: `pytest tests/unit_tests/ir`. | Links: scratchpad `agents/scratchpads/T-022_nfir_dialect_converter.md`.

## Backlog
- T-023 | Status: Backlog | Owner: Executor | DoD: Implement ASDL_NFIR → ASDL_CIR lowering for MVP; invert nets into named-only instance conns; preserve `port_order` as a first-class attribute (no recompute); add conversion tests. | Verify: `pytest tests/unit_tests/ir`. | Links: scratchpad `agents/scratchpads/T-023_nfir_to_cir.md`.
- T-024 | Status: Backlog | Owner: Executor | DoD: Implement ASDL_NLIR dialect (`asdl_nlir` with `elab_state` u/e) + ASDL_CIR → ASDL_NLIR_U lowering; preserve `port_order`; ASDL_NLIR_U → ASDL_NLIR_E is identity in MVP; add tests. | Verify: `pytest tests/unit_tests/ir`. | Links: scratchpad `agents/scratchpads/T-024_nlir_dialect_lowering.md`.
- T-025 | Status: Backlog | Owner: Executor | DoD: Minimal netlist emitter from ASDL_NLIR_E; preserve port order in emitted netlists; add golden tests for simple circuits. | Verify: `pytest tests/unit_tests/netlist`. | Links: scratchpad `agents/scratchpads/T-025_netlist_emitter_mvp.md`.
- T-026 | Status: Backlog | Owner: Executor | DoD: End-to-end MVP pipeline test: parse ASDL_A → NFIR → CIR → NLIR_E → emit; validate output determinism and port order propagation. | Verify: `pytest tests/unit_tests/e2e`. | Links: scratchpad `agents/scratchpads/T-026_e2e_mvp.md`.
- T-013 | Status: Blocked | Owner: Executor | DoD: Implement IR passes (alias expansion, link/resolve, SelectView) per `docs/specs/spec_asdl_cir.md` with diagnostics; add pass-level tests for default view selection and dummy coupling. | Verify: `pytest tests/unit_tests/passes`. | Links: scratchpad `agents/scratchpads/T-013_ir_passes.md`. (Blocked: view system deferred.)
- T-014 | Status: Backlog | Owner: Executor | DoD: Full netlist/SPICE emission from ASDL_NLIR_E with backend templates; preserve port order and named-only conns; add golden netlist tests for simple designs. | Verify: `pytest tests/unit_tests/netlist`. | Links: scratchpad `agents/scratchpads/T-014_netlist_emission.md`.
- T-015 | Status: Backlog | Owner: Executor | DoD: Remove remaining legacy dataclass AST/parsing modules and update imports/exports to new AST; ensure package exports and docs reference new AST (legacy pipeline and tests already archived under `legacy/`). | Verify: `pytest`. | Links: scratchpad `agents/scratchpads/T-015_legacy_cleanup.md`.
- T-018 | Status: Backlog | Owner: Executor | DoD: Implement lint rule registry, config loading, and `asdl lint` command; run rules against AST/IR; support severity overrides and `--max-warnings`. | Verify: `pytest tests/unit_tests/lint`. | Links: scratchpad `agents/scratchpads/T-018_linter.md`.
- T-019 | Status: Backlog | Owner: Executor | DoD: Implement LSP diagnostic bridge (convert core diagnostics to LSP ranges, publish per-file updates); reuse shared pipeline for on-change runs. | Verify: `pytest tests/unit_tests/lsp` or documented manual LSP smoke. | Links: scratchpad `agents/scratchpads/T-019_lsp_diagnostics.md`.
- T-030 | Status: Backlog | Owner: Executor | DoD: Implement domain wildcard sugar (AST→NFIR); resolve wildcard domains while preserving basename+domain representation; add tests. | Verify: `pytest tests/unit_tests/parser`. | Links: scratchpad `agents/scratchpads/T-030_domain_wildcards.md`.
- T-031 | Status: Backlog | Owner: Executor | DoD: Implement pattern elaboration pass to expand domains into explicit names/endpoints before ASDL_NLIR_E; add tests for zip/broadcast rules. | Verify: `pytest tests/unit_tests/ir`. | Links: scratchpad `agents/scratchpads/T-031_pattern_elaboration.md`.
- T-032 | Status: Backlog | Owner: Executor | DoD: Support inline pin-bind + suffix block sugar in ASDL_A; lower into explicit nets/instances; add tests. | Verify: `pytest tests/unit_tests/parser`. | Links: scratchpad `agents/scratchpads/T-032_inline_sugar.md`.
- T-033 | Status: Backlog | Owner: Executor | DoD: Implement `exports:` block lowering to `$` nets with conflict detection; add tests. | Verify: `pytest tests/unit_tests/parser`. | Links: scratchpad `agents/scratchpads/T-033_exports_block.md`.
- T-034 | Status: Backlog | Owner: Executor | DoD: Define and implement view manifest sidecar format + selection hook (post-MVP); add tests for view compatibility. | Verify: `pytest tests/unit_tests/passes`. | Links: scratchpad `agents/scratchpads/T-034_view_manifest.md`.
- T-035 | Status: Backlog | Owner: Executor | DoD: Implement import system for ASDL_A with namespace resolution; add tests. | Verify: `pytest tests/unit_tests/parser`. | Links: scratchpad `agents/scratchpads/T-035_imports.md`.

## Done
- T-010 | Status: Done | Owner: Executor | DoD: Implement Pydantic v2 AST models aligned with `docs/specs/spec_ast.md` (AsdlDocument, ModuleDecl, ViewDecl union by kind, SubcktRef/Dummy/Behav, ParamValue); enforce AST hard requirements (non-empty templates, dummy name/kind coupling, conns mapping); add `model_json_schema` export; add focused unit tests for validation edge cases. | Verify: `pytest tests/unit_tests/ast`. | Links: scratchpad `agents/scratchpads/T-010_ast_pydantic.md`.
- T-011 | Status: Done | Owner: Executor | DoD: Build YAML parser using ruamel → plain dict → Pydantic validation; implement LocationIndex to map YAML paths to Locatable; map Pydantic ValidationError into `Diagnostic` with correct locations; update parser API (`parse_file`/`parse_string`) to return AST + diagnostics; add location-mapping tests. | Verify: `pytest tests/unit_tests/parser`. | Links: scratchpad `agents/scratchpads/T-011_parser_locatable.md`, PR https://github.com/Jianxun/ASDL/pull/20.
- T-012 | Status: Done (Pre-rename; superseded by T-020) | Owner: Executor | DoD: Implement xDSL `asdl_cir` dialect ops/attrs per `docs/specs/spec_asdl_cir.md` with verifiers; update AST→IR converter to emit `asdl_cir.design/module/view/...` and enforce canonical `nominal` during emission; add unit tests (skip if xdsl optional dep missing). | Verify: `pytest tests/unit_tests/ir`. | Links: scratchpad `agents/scratchpads/T-012_ir_dialect_converter.md`, PR https://github.com/Jianxun/ASDL/pull/21.
- T-016 | Status: Done | Owner: Executor | DoD: Implement diagnostic core types (Diagnostic, Severity, SourceSpan, Label, Note, FixIt), a collector sink, and text/JSON renderers with deterministic ordering. | Verify: `pytest tests/unit_tests/diagnostics`. | Links: scratchpad `agents/scratchpads/T-016_diagnostic_core.md`, PR https://github.com/Jianxun/ASDL/pull/19.
- T-001 | Status: Done (Superseded by T-010) | Owner: Architect | DoD: ADR-0001 reflected in schema plan; draft schema/pydantic shape for views with reserved kinds (subckt, subckt_ref, primitive, dummy) and reserved names (nominal/nom, dummy); confirm ordering decision (lists where order matters) for view substructures; file updates staged for review (schema draft or design doc). | Verify: none (design task). | Links: ADR-0001, scratchpad `agents/scratchpads/ASDL_schema_refactor.md`.
- T-002 | Status: Done (Superseded by T-010) | Owner: Architect | DoD: Define data model/spec for view payloads by kind (fields for subckt, subckt_ref/PEX mapping, primitive/spice_template, dummy) and document validation expectations (validate all views as if used); update scratchpad with field tables and invariants. | Verify: none (design task). | Links: ADR-0001, scratchpad `agents/scratchpads/ASDL_schema_refactor.md`.
- T-003 | Status: Done (Superseded by T-013) | Owner: Architect | DoD: Specify and design the SelectView compiler pass; selection runs after config/view_order application; pass validates all views as if they will be used; outputs resolved (module, view) mapping and diagnostics strategy; update scratchpad with pass contract and verify plan. | Verify: none (design task). | Links: ADR-0001, scratchpad `agents/scratchpads/ASDL_schema_refactor.md`.
