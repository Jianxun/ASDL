schema_version: 2

current_sprint:
  - id: T-228
    title: Refactor ASDL visualizer extension into multi-file modules
    owner: Executor
    dod: >
      Split `extensions/asdl-visualizer/src/extension.ts` into focused modules
      under `extensions/asdl-visualizer/src/extension/` (commands, webview,
      layout, symbols, dump runner, util/types) and keep `extension.ts` as a
      thin entrypoint. Ensure behavior remains unchanged and `npm run build`
      succeeds.
    verify:
      - npm run build
    links:
      scratchpad: agents/scratchpads/T-228_visualizer_refactor.md
    files:
      - extensions/asdl-visualizer/src/extension.ts
      - extensions/asdl-visualizer/src/extension/
  - id: T-229
    title: Add asdlc visualizer-dump CLI (minimal JSON)
    owner: Executor
    dod: >
      Add `asdlc visualizer-dump` with `--module`, `--list-modules`, and
      `--compact` flags. Emit minimal JSON to stdout with
      {schema_version, module, instances, nets, endpoints, registries,
      refs.modules, refs.devices}. `--list-modules` outputs module list JSON
      for the entry file only. Diagnostics go to stderr; non-zero exit on
      failures. No files are written.
    verify:
      - ./venv/bin/asdlc visualizer-dump examples/**/*.asdl --list-modules
    links:
      scratchpad: agents/scratchpads/T-229_visualizer_dump_cli.md
    files:
      - src/asdl/cli/__init__.py
      - src/asdl/core/dump.py
      - src/asdl/core/pipeline.py
  - id: T-230
    title: Extension runs asdlc visualizer-dump + module selection
    owner: Executor
    depends_on:
      - T-229
    dod: >
      Replace dump file selection with `asdlc visualizer-dump` invoked via PATH.
      If multiple modules exist, prompt via QuickPick and re-run with `--module`.
      Parse minimal JSON and feed the webview. Surface friendly errors when
      `asdlc` is missing or the command fails. No dumps are written to disk.
    verify:
      - npm run build
    links:
      scratchpad: agents/scratchpads/T-230_visualizer_dump_extension.md
    files:
      - extensions/asdl-visualizer/src/extension.ts
      - extensions/asdl-visualizer/src/extension/
  - id: T-231
    title: Symbol loading + pin placement + top-left instance anchors
    owner: Executor
    depends_on:
      - T-228
    dod: >
      Load `design.sym.yaml` for module/device symbols via `file_id` refs from
      the visualizer dump. Implement unified symbol schema (body, pins, optional
      glyph, pin_offsets). Apply pin placement rules with floor-biased centering
      and 1-grid spacing. Use top-left anchors for instance layout; keep hubs
      center-based. Update React Flow nodes/handles and save path accordingly.
    verify:
      - npm run build
    links:
      scratchpad: agents/scratchpads/T-231_visualizer_symbols.md
    files:
      - extensions/asdl-visualizer/src/extension.ts
      - extensions/asdl-visualizer/src/extension/
      - extensions/asdl-visualizer/src/webview/app.tsx
      - extensions/asdl-visualizer/src/webview/styles.css
