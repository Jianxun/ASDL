schema_version: 2

current_sprint:
  - id: T-264
    title: Update visualizer routing spec for dynamic MST and single-trunk
    owner: Architect
    dod: >
      Refactor the visualizer spec into smaller files (overview index plus
      symbols/layout/routing/extension specs). Document MST recomputation on
      layout changes, MST including the hub as a node, and single-trunk
      routing aligned to hub orientation. Specify that the trunk passes
      through the hub, extends in both directions along the trunk axis, and
      branches orthogonally to endpoints without intermediate anchors.
    verify: []
    links:
      scratchpad: agents/scratchpads/T-264_visualizer_trunk_spec.md
    files:
      - docs/specs/spec_asdl_visualizer.md
      - docs/specs/spec_asdl_visualizer_symbols.md
      - docs/specs/spec_asdl_visualizer_layout.md
      - docs/specs/spec_asdl_visualizer_routing.md
      - docs/specs/spec_asdl_visualizer_extension.md
  - id: T-269
    title: Refactor visualizer webview app module
    owner: Executor
    dod: >
      Split extensions/asdl-visualizer/src/webview/app.tsx into smaller
      modules without changing runtime behavior. Extract: (1) routing
      algorithms (star/mst/trunk), (2) layout/geometry helpers (orient
      transforms, pin placement, grid conversions), (3) node components
      (instance/hub/junction), (4) message handling + state hooks, and
      (5) shared constants/types. Keep ReactFlow wiring intact and update
      imports/exports accordingly.
    verify:
      - npm --prefix extensions/asdl-visualizer run build:webview
    links:
      scratchpad: agents/scratchpads/T-269_visualizer_webview_refactor.md
    files:
      - extensions/asdl-visualizer/src/webview/app.tsx
      - extensions/asdl-visualizer/src/webview/nodes/InstanceNode.tsx
      - extensions/asdl-visualizer/src/webview/nodes/HubNode.tsx
      - extensions/asdl-visualizer/src/webview/graph/routing.ts
      - extensions/asdl-visualizer/src/webview/graph/layout.ts
      - extensions/asdl-visualizer/src/webview/graph/geometry.ts
      - extensions/asdl-visualizer/src/webview/state/useVisualizerState.ts
  - id: T-270
    title: Recompute routing on layout changes
    owner: Executor
    depends_on:
      - T-269
    dod: >
      Update the visualizer webview so topology routing recomputes whenever
      node positions change (drag/move), including MST. Ensure the updated
      edge graph preserves pin label behavior and connect_by_label
      suppression. Update dev harness/payload fixtures to exercise dynamic
      recompute.
    verify:
      - npm --prefix extensions/asdl-visualizer run build:webview
    links:
      scratchpad: agents/scratchpads/T-270_visualizer_dynamic_recompute.md
    files:
      - extensions/asdl-visualizer/src/webview/app.tsx
      - extensions/asdl-visualizer/src/webview/devHarness.ts
      - extensions/asdl-visualizer/src/webview/public/dev_payload.json
  - id: T-271
    title: Implement single-trunk routing policy
    owner: Executor
    depends_on:
      - T-269
    dod: >
      Update trunk routing to a single hub-aligned trunk through the hub that
      extends in both directions along the trunk axis and connects each
      endpoint with one orthogonal branch. Ensure endpoints behind the hub
      are reachable and no intermediate anchors are introduced. Update dev
      harness/payload fixtures to cover behind-hub endpoints.
    verify:
      - npm --prefix extensions/asdl-visualizer run build:webview
    links:
      scratchpad: agents/scratchpads/T-271_visualizer_trunk_policy.md
    files:
      - extensions/asdl-visualizer/src/webview/app.tsx
      - extensions/asdl-visualizer/src/webview/devHarness.ts
      - extensions/asdl-visualizer/src/webview/public/dev_payload.json
  - id: T-266
    title: Add visualizer reload action for .sch.yaml refresh
    owner: Executor
    depends_on:
      - T-269
    dod: >
      Add a reload control in the visualizer webview that re-reads the
      companion .sym.yaml/.sch.yaml files and refreshes the rendered graph
      without closing the view. The action should request a reload from the
      extension host and preserve the current pan/zoom if possible. Document
      the reload affordance in the visualizer spec or extension README.
    verify:
      - npm --prefix extensions/asdl-visualizer run build
    links:
      scratchpad: agents/scratchpads/T-266_visualizer_reload.md
    files:
      - extensions/asdl-visualizer/src/extension/extension.ts
      - extensions/asdl-visualizer/src/webview/app.tsx
      - docs/specs/spec_asdl_visualizer.md
  - id: T-267
    title: Support launching visualizer from .sch.yaml with hotkey
    owner: Executor
    dod: >
      Allow the visualizer command to launch when the active editor is either
      a .asdl or .sch.yaml file, resolving the companion .asdl as needed.
      Bind a keybinding matching Markdown preview (Cmd+Shift+V on macOS, and
      the corresponding Ctrl+Shift+V on Windows/Linux) without conflicting
      with existing ASDL commands. Update extension contribution metadata and
      document the new launch behavior.
    verify:
      - npm --prefix extensions/asdl-visualizer run build:extension
    links:
      scratchpad: agents/scratchpads/T-267_visualizer_launch_hotkey.md
    files:
      - extensions/asdl-visualizer/package.json
      - extensions/asdl-visualizer/src/extension/extension.ts
      - docs/specs/spec_asdl_visualizer.md

backlog:
  - id: T-268
    title: Scope symbol sidecar generation/editor workflow
    owner: Architect
    dod: >
      Provide a short proposal for generating and editing .sym.yaml files,
      including whether to reuse the schematic visualizer (single-node mode)
      or create a dedicated symbol editor. Identify the minimal UI/actions
      needed to create/update symbols, how glyphs are positioned, and any
      required schema changes or new commands.
    verify: []
    links:
      scratchpad: agents/scratchpads/T-268_symbol_editor_scope.md
    files:
      - docs/specs/spec_asdl_visualizer.md
  - id: T-272
    title: Parse project manifest v1 + library expansion
    owner: Executor
    dod: >
      Update the Sphinx ASDL domain to parse the v1 project manifest schema
      (schema_version, project_name, readme, docs, entrances, libraries)
      while preserving YAML list order. Library entries must expand all
      .asdl files under each library root, honoring exclude globs relative
      to the library root (no implicit filtering). Remove legacy manifest
      entry sorting/expansion from the project flow. Add unit coverage for
      parsing and exclude handling.
    verify:
      - ./venv/bin/pytest tests/unit_tests/docs/test_sphinx_project_manifest.py -v
    links:
      scratchpad: agents/scratchpads/T-272_sphinx_project_manifest_v1.md
    files:
      - src/asdl/docs/sphinx_domain.py
      - tests/unit_tests/docs/test_sphinx_project_manifest.py
      - tests/unit_tests/docs/fixtures/project_manifest_v1
  - id: T-273
    title: Render project nav page (README/docs/entrances/libraries)
    owner: Executor
    depends_on:
      - T-272
    dod: >
      Generate a project nav page that orders entries as README, docs,
      entrances, then libraries. README label uses project_name when set,
      otherwise the document title. Entrances must render file+module
      references with descriptions. Update the example Sphinx index to
      include only the generated project page (no duplicate README entry).
      Add unit coverage for nav ordering and entrance link rendering.
    verify:
      - ./venv/bin/pytest tests/unit_tests/docs/test_sphinx_project_manifest.py -v
    links:
      scratchpad: agents/scratchpads/T-273_sphinx_project_nav.md
    files:
      - src/asdl/docs/sphinx_domain.py
      - tests/unit_tests/docs/test_sphinx_project_manifest.py
      - examples/docs/index.rst
