schema_version: 2

current_sprint:
  - id: T-226
    title: AtomizedGraph per-atom pattern origins
    owner: Executor
    dod: >
      Add an AtomizedPatternOrigin (or equivalent) dataclass in
      `src/asdl/core/atomized_graph.py` with explicit
      {expression_id, segment_index, atom_index, base_name, pattern_parts}.
      Add optional `pattern_origin` fields to AtomizedNet/AtomizedInstance/AtomizedEndpoint.
      Populate these fields during atomization by expanding patterns with
      a helper that returns atoms + parts (reuse/relocate logic from
      `_expand_pattern_atoms` in `atomized_graph_to_netlist_ir.py`).
      Ensure atomized origins are attached per literal atom (not per patterned id).
      Update `src/asdl/core/dump.py` to include atomized pattern origins in dumps.
    verify:
      - venv/bin/pytest tests/unit_tests/netlist -v
    links:
      scratchpad: agents/scratchpads/T-226_atomized_pattern_origins.md
    files:
      - src/asdl/core/atomized_graph.py
      - src/asdl/lowering/patterned_graph_to_atomized_nets.py
      - src/asdl/lowering/patterned_graph_to_atomized_instances.py
      - src/asdl/lowering/patterned_graph_to_atomized_patterns.py
      - src/asdl/core/dump.py
  - id: T-227
    title: NetlistIR consumes atomized pattern origins
    owner: Executor
    depends_on:
      - T-226
    dod: >
      Remove origin reconstruction in `src/asdl/lowering/atomized_graph_to_netlist_ir.py`
      and instead copy Atomized* `pattern_origin` into NetlistIR nets/instances.
      Delete/retire `_PatternOriginResolver` or reduce it to building the
      pattern_expression_table from `expression_id` values found in atomized origins.
      Keep NetlistIR `pattern_expression_table` wiring intact for verifier/rendering.
      Update/extend emit tests to assert numeric pattern rendering now applies to all
      atoms (e.g., BUS[25], BUS[24], pin[130], pin[129], sw_row[130], sw_row[129]).
    verify:
      - venv/bin/pytest tests/unit_tests/emit -v
    links:
      scratchpad: agents/scratchpads/T-227_netlist_ir_atomized_origins.md
    files:
      - src/asdl/lowering/atomized_graph_to_netlist_ir.py
      - src/asdl/emit/netlist/render.py
      - src/asdl/emit/verify_netlist_ir.py
      - tests/unit_tests/emit/
backlog: []
