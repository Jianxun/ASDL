schema_version: 2

current_sprint:
  - id: T-325
    title: Add entry-only global_parameters to AST and import validation
    owner: Executor
    dod: >
      Introduce top-level `global_parameters` in AST models/spec plumbing and
      enforce entry-file-only declaration semantics in import-aware lowering.
      Imported files that declare `global_parameters` must produce a deterministic
      diagnostic. Preserve existing module/device parsing behavior and
      deterministic ordering of declared global parameter keys.
    verify:
      - ./venv/bin/pytest tests/unit_tests/ast/test_models.py tests/unit_tests/core/test_patterned_graph_lowering.py tests/unit_tests/cli/test_netlist.py -v
    links:
      scratchpad: agents/scratchpads/T-325_entry_global_parameters_ast_validation.md
      spec: docs/specs/spec_ast.md
      adr: agents/adr/ADR-0042-entry-global-parameters.md
    files:
      - src/asdl/ast/models.py
      - src/asdl/lowering/ast_to_patterned_graph.py
      - tests/unit_tests/ast/test_models.py
      - tests/unit_tests/core/test_patterned_graph_lowering.py
  - id: T-326
    title: Carry global parameters through NetlistIR and emit declaration block
    owner: Executor
    depends_on:
      - T-325
    dod: >
      Extend NetlistIR design/lowering structures to carry entry
      `global_parameters` in deterministic declaration order, then emit
      backend-owned global-parameter declaration lines immediately after
      `__netlist_header__` and before first instance/module emission. Keep
      module parameter semantics unchanged and preserve existing netlist header/
      footer behavior.
    verify:
      - ./venv/bin/pytest tests/unit_tests/lowering/test_atomized_graph_to_netlist_ir.py tests/unit_tests/netlist/test_netlist_render_netlist_ir.py -v
    links:
      scratchpad: agents/scratchpads/T-326_global_parameters_netlistir_emit.md
      spec: docs/specs/spec_netlist_ir.md
      adr: agents/adr/ADR-0042-entry-global-parameters.md
    files:
      - src/asdl/emit/netlist_ir.py
      - src/asdl/lowering/atomized_graph_to_netlist_ir.py
      - src/asdl/emit/netlist/render.py
      - tests/unit_tests/lowering/test_atomized_graph_to_netlist_ir.py
      - tests/unit_tests/netlist/test_netlist_render_netlist_ir.py
  - id: T-327
    title: Implement backend-aware !{name} global-parameter reference resolution
    owner: Executor
    depends_on:
      - T-326
    dod: >
      Implement emission-time resolution for `!{name}` tokens in backend-rendered
      parameter/template contexts using backend-owned reference style policy
      (brace vs bare forms). All `!{name}` tokens must resolve against declared
      entry `global_parameters`; unresolved references emit deterministic fatal
      diagnostics. Keep `{var}` module-variable substitution behavior unchanged.
    verify:
      - ./venv/bin/pytest tests/unit_tests/netlist/test_netlist_render_netlist_ir.py tests/unit_tests/cli/test_netlist.py -v
    links:
      scratchpad: agents/scratchpads/T-327_global_parameter_token_resolution.md
      spec: docs/specs/spec_netlist_emission.md
      adr: agents/adr/ADR-0042-entry-global-parameters.md
    files:
      - src/asdl/emit/netlist/render.py
      - src/asdl/emit/netlist/templates.py
      - tests/unit_tests/netlist/test_netlist_render_netlist_ir.py
      - tests/unit_tests/cli/test_netlist.py
  - id: T-328
    title: Add backend config policy, examples, and migration coverage for globals
    owner: Executor
    depends_on:
      - T-327
    dod: >
      Add backend config support for global-parameter declaration/reference style
      (ngspice/xyce/spectre), update example configs/docs to use first-class
      `global_parameters`, and add regression coverage proving cross-backend
      emission and unresolved-token diagnostics. Document temporary compatibility
      posture for legacy `sim.param` device patterns if retained.
    verify:
      - ./venv/bin/pytest tests/unit_tests/emit/test_backend_config.py tests/unit_tests/netlist/test_netlist_render_netlist_ir.py tests/unit_tests/e2e/test_pipeline_mvp.py -v
    links:
      scratchpad: agents/scratchpads/T-328_global_parameter_backend_coverage.md
      spec: docs/specs/spec_netlist_emission.md
      adr: agents/adr/ADR-0042-entry-global-parameters.md
    files:
      - src/asdl/emit/backend_config.py
      - examples/config/backends.yaml
      - examples/libs/scratch/cc_nmos.asdl
      - tests/unit_tests/emit/test_backend_config.py
      - tests/unit_tests/netlist/test_netlist_render_netlist_ir.py
      - tests/unit_tests/e2e/test_pipeline_mvp.py
backlog: []
