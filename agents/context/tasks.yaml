schema_version: 2

current_sprint:
  - id: T-078
    title: Propagate per-entry source spans into NFIR/IFIR
    owner: Executor
    dod: >
      Capture YAML locations for `nets` and `instances` map entries during parsing
      and store them as ModuleDecl private metadata. Use these locations to set
      `src` on NFIR NetOp/InstanceOp and carry them through NFIR->IFIR so
      downstream diagnostics resolve to file/line/col. Update IR diagnostics
      tests so errors tied to net/instance data include non-null spans.
    verify:
      - pytest tests/unit_tests/ir -v
    files:
      - src/asdl/ast/models.py
      - src/asdl/ast/parser.py
      - src/asdl/ir/converters/ast_to_nfir.py
      - src/asdl/ir/converters/nfir_to_ifir.py
      - tests/unit_tests/ir/test_converter.py
    links:
      scratchpad: agents/scratchpads/T-078_diagnostics_spans_ir.md
  - id: T-079
    title: End-to-end diagnostics span coverage
    owner: Executor
    dod: >
      Add e2e diagnostics tests that run parse/lower/emit flows with known
      failures and assert each emitted diagnostic has a populated
      `primary_span` (no `NO_SPAN_NOTE`). Cover at least one error from the
      parser, IR lowering, and netlist verification/emission stages.
    verify:
      - pytest tests/unit_tests/e2e -v
    files:
      - tests/unit_tests/e2e/test_pipeline_mvp.py
      - tests/unit_tests/netlist/test_netlist_emitter.py
    links:
      scratchpad: agents/scratchpads/T-079_diagnostics_spans_e2e.md
  - id: T-080
    title: Netlist header timestamp placeholders
    owner: Executor
    dod: >
      Add `emit_date` and `emit_time` placeholders for `__netlist_header__` and
      `__netlist_footer__` system devices. Capture a single emit timestamp per
      netlist (plumbed via `EmitOptions`/`emit_netlist`) and format it into the
      new placeholders. Template validation must accept the new placeholders.
      Update the MVP netlist emission spec to document the placeholders and
      that emission depends entirely on backend templates. Netlist tests must
      cover substitution with a deterministic timestamp.
    verify:
      - pytest tests/unit_tests/netlist -v
    files:
      - src/asdl/emit/netlist/api.py
      - src/asdl/emit/netlist/render.py
      - src/asdl/emit/netlist/templates.py
      - tests/unit_tests/netlist/test_netlist_emitter.py
      - docs/specs_mvp/spec_netlist_emission_mvp.md
    links:
      scratchpad: agents/scratchpads/T-080_netlist_header_time.md
  - id: T-081
    title: Import path env var expansion
    owner: Executor
    dod: >
      Ensure import path resolution expands `~` and `$VAR`/`${VAR}` in `imports`
      path values and in `ASDL_LIB_PATH` entries. Add tests that cover env var
      expansion for direct import paths and logical-path resolution via
      `ASDL_LIB_PATH` (including `~`). If expansion fails or yields empty paths,
      emit `AST-011` malformed import diagnostics.
    verify:
      - pytest tests/unit_tests/parser/test_import_resolution.py -v
    files:
      - src/asdl/imports/resolver.py
      - tests/unit_tests/parser/test_import_resolution.py
      - docs/specs/spec_asdl_import.md
    links:
      scratchpad: agents/scratchpads/T-081_import_env_expansion.md
  - id: T-082
    title: Inline pin bindings in AST->NFIR conversion
    owner: Executor
    dod: >
      Parse inline pin bindings in instance expressions using the
      `(<port>:<net> ...)` whitespace-separated form. Merge bindings into the
      module net map (creating nets as needed), and allow `$`-prefixed inline
      net names to create ports when not declared in `nets`. Port order is
      `$` nets from `nets` first, then `$` nets first-seen in inline bindings.
      Emit conversion diagnostics for malformed pin-binding tokens and for
      endpoints bound in both `nets` and inline bindings. Update MVP AST/NFIR
      specs to allow inline bindings and describe the rules. Add unit tests that
      cover inline bindings, overlap errors, and inline-created ports.
    verify:
      - pytest tests/unit_tests/ir/test_converter.py -v
    files:
      - src/asdl/ir/converters/ast_to_nfir.py
      - tests/unit_tests/ir/test_converter.py
      - docs/specs_mvp/spec_ast_mvp.md
      - docs/specs_mvp/spec_asdl_nfir_mvp.md
    links:
      scratchpad: agents/scratchpads/T-082_inline_pin_bindings.md
  - id: T-083
    title: Inline pin bindings netlist coverage
    owner: Executor
    depends_on:
      - T-082
    dod: >
      Add netlist or end-to-end tests that exercise inline pin bindings and
      confirm emitted connectivity matches expected ports/nets without listing
      every endpoint in `nets`. Cover at least one case that relies solely on
      inline bindings for internal nets, and one case where `$` inline bindings
      create ports and affect emitted port order.
    verify:
      - pytest tests/unit_tests/netlist/test_netlist_emitter.py -v
    files:
      - tests/unit_tests/netlist/test_netlist_emitter.py
      - tests/unit_tests/e2e/test_pipeline_mvp.py
    links:
      scratchpad: agents/scratchpads/T-083_inline_pin_bindings_netlist.md

backlog: []
exploration_candidates:
  - IFIR diagnostics spans: mapping strategy, edge cases, and test fixtures.
  - CLI pipeline UX: command flow, error messaging, and file layout.
  - Netlist emission validation: strictness vs warnings; validation stages.
  - xDSL pipeline boundaries: pass split/merge opportunities and IR boundaries.
  - Codebase map gaps: navigation audit for future Executors.
