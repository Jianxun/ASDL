schema_version: 2

current_sprint: []
backlog:
  - id: T-090
    title: Pattern atomization helpers
    owner: Executor
    dod: >
      Add atomization helpers in `src/asdl/patterns.py` that expand a pattern
      token into single-atom pattern tokens with emitted literal names and
      origin metadata, including base-less patterns. Provide endpoint
      atomization helpers and diagnostics for malformed tokens. Add parser-level
      unit tests for atomization outputs and error cases.
    verify:
      - pytest tests/unit_tests/parser/test_pattern_atomization.py -v
    files:
      - src/asdl/patterns.py
      - tests/unit_tests/parser/test_pattern_atomization.py
    links:
      adr: agents/adr/ADR-0011-pattern-atomization-collisions.md
  - id: T-091
    title: Pattern atomization pass and IFIR metadata
    owner: Executor
    depends_on:
      - T-090
    dod: >
      Add optional `pattern_origin` metadata on IFIR net/instance ops and
      implement a PatternAtomizePass that expands multi-atom patterns into
      single-atom tokens, validates literal-name collisions, and enforces that
      endpoint instance atoms resolve to declared instance atoms. Reuse the
      existing patterned-parameter expansion rules to materialize per-atom
      params during atomization (broadcast/zip with diagnostics). Wire the pass
      into the MVP pipeline after NFIR->IFIR. Add unit tests for subset endpoint
      bindings, base-less pattern forwarding, parameter expansion, and collision
      diagnostics.
    verify:
      - pytest tests/unit_tests/ir/test_pattern_atomization.py -v
    files:
      - src/asdl/ir/nfir/dialect.py
      - src/asdl/ir/ifir/dialect.py
      - src/asdl/ir/pattern_atomization.py
      - src/asdl/ir/pipeline.py
      - tests/unit_tests/ir/test_pattern_atomization.py
    links:
      adr: agents/adr/ADR-0011-pattern-atomization-collisions.md
  - id: T-092
    title: Netlist emission assumes atomized IFIR
    owner: Executor
    depends_on:
      - T-091
    dod: >
      Remove pattern elaboration from netlist emission and update netlist tests
      to rely on atomized IFIR output. Replace or retire pattern elaboration
      tests as needed and add coverage to ensure emit-time does not expand
      patterns.
    verify:
      - pytest tests/unit_tests/netlist/test_netlist_emitter.py -v
    files:
      - src/asdl/emit/netlist/api.py
      - tests/unit_tests/netlist/test_netlist_emitter.py
      - tests/unit_tests/ir/test_pattern_elaboration.py
    links:
      adr: agents/adr/ADR-0011-pattern-atomization-collisions.md

exploration_candidates:
  - IFIR diagnostics spans: mapping strategy, edge cases, and test fixtures.
  - CLI pipeline UX: command flow, error messaging, and file layout.
  - Netlist emission validation: strictness vs warnings; validation stages.
  - xDSL pipeline boundaries: pass split/merge opportunities and IR boundaries.
  - Codebase map gaps: navigation audit for future Executors.
