# T-097: NFIR endpoint resolution uses atomized equivalence

## Task summary (DoD + verify)
- Update NFIR module verification to resolve endpoint instance names via atomized literals (allowing subset pattern tokens) and to detect duplicate endpoints after atomization.
- Update NFIR->IFIR conversion to map endpoint instance tokens to owning instance ops using the same atomized literal mapping.
- Add unit tests covering subset endpoint bindings and atomized duplicate detection.
- Verify: `pytest tests/unit_tests/ir/test_dialect.py tests/unit_tests/ir/test_ifir_converter.py -v`

## Read
- agents/context/lessons.md
- agents/context/contract.md
- agents/context/tasks.yaml
- agents/context/tasks_state.yaml
- agents/context/project_status.md
- agents/adr/ADR-0012-nfir-atomized-endpoint-resolution.md

## Plan
- Inspect NFIR module verification and NFIR->IFIR conversion for endpoint checks.
- Add tests for subset endpoint bindings and atomized endpoint duplicates.
- Implement atomized endpoint resolution and duplicate detection in NFIR verification.
- Implement atomized endpoint-to-instance mapping in NFIR->IFIR conversion.
- Run verify command.

## Progress log
- Understanding: allow endpoint instance tokens that are subsets of instance patterns by matching via atomized literal names; detect endpoint collisions after atomization; use same mapping in NFIR->IFIR conversion.
- Todo:
  - [x] Add tests for subset endpoint bindings and atomized duplicate detection.
  - [x] Update NFIR module verification to use atomized literal mapping for endpoints.
  - [x] Update NFIR->IFIR conversion to use atomized literal mapping for endpoint routing.
  - [x] Run verification tests.

## Patch summary
- Added NFIR dialect tests for subset endpoint bindings and atomized duplicate detection.
- Added IFIR converter test covering subset endpoint instance mapping.
- Updated NFIR module verification to resolve endpoints via atomized literals and detect atomized duplicates.
- Updated NFIR->IFIR conversion to reuse atomized pattern caches for endpoint mapping and pattern binding checks.

## PR URL
https://github.com/Jianxun/ASDL/pull/107

## Verification
- `./venv/bin/pytest tests/unit_tests/ir/test_dialect.py tests/unit_tests/ir/test_ifir_converter.py -v`

## Status request (Done / Blocked / In Progress)
Done

## Blockers / Questions

## Next steps
