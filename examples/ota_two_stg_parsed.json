{
  "defaults": {
    "CAP": {
      "model": "capacitor_unit"
    },
    "NMOS": {
      "B": "VSS",
      "model": "nmos_unit"
    },
    "PMOS": {
      "B": "VDD",
      "model": "pmos_unit"
    }
  },
  "modules": {
    "bias_vbn_diode": {
      "circuits": [
        {
          "model": "nmos_unit",
          "name": "MN_bias",
          "nets": {},
          "parameters": {
            "B": "VSS",
            "D": "iref",
            "G": "vbn",
            "M": "${M}",
            "S": "vss"
          }
        },
        {
          "model": "jumper",
          "name": "J1",
          "nets": {},
          "parameters": {
            "name": "J1",
            "p1": "iref",
            "p2": "vbn"
          }
        }
      ],
      "name": "bias_vbn_diode",
      "nets": {
        "iref": "in",
        "vbn": "out",
        "vss": "io"
      },
      "notes": {
        "layout": "match all current sources driven by vbn"
      },
      "parameters": {
        "M": 1
      }
    },
    "common_source_amp": {
      "circuits": [
        {
          "model": "pmos_unit",
          "name": "MP_DRV",
          "nets": {},
          "parameters": {
            "B": "VDD",
            "D": "out",
            "G": "in",
            "M": "${M}",
            "S": "vdd"
          }
        },
        {
          "model": "nmos_unit",
          "name": "MN_LOAD",
          "nets": {},
          "parameters": {
            "B": "VSS",
            "D": "out",
            "G": "vbn",
            "M": "${M}",
            "S": "vss"
          }
        }
      ],
      "name": "common_source_amp",
      "nets": {
        "in": "in",
        "out": "out",
        "vbn": "in",
        "vdd": "io",
        "vss": "io"
      },
      "notes": {},
      "parameters": {
        "M": 1
      }
    },
    "current_mirror_pmos_1_1": {
      "circuits": [
        {
          "model": "pmos_unit",
          "name": "MP_{ref,out}",
          "nets": {},
          "parameters": {
            "B": "VDD",
            "D": "{ref, out}",
            "G": "ref",
            "M": "${M}",
            "S": "vdd"
          }
        }
      ],
      "name": "current_mirror_pmos_1_1",
      "nets": {
        "out": "out",
        "ref": "in",
        "vdd": "io"
      },
      "notes": {},
      "parameters": {
        "M": 1
      }
    },
    "diff_pair_nmos": {
      "circuits": [
        {
          "model": "nmos_unit",
          "name": "MN_{P,N}",
          "nets": {},
          "parameters": {
            "B": "VSS",
            "D": "out_{p,n}",
            "G": "in_{p,n}",
            "M": "${M}",
            "S": "tail"
          }
        }
      ],
      "name": "diff_pair_nmos",
      "nets": {
        "in_{p,n}": "in",
        "out_{p,n}": "out",
        "tail": "io"
      },
      "notes": {
        "layout": "cross quad common centroid, use even number of M"
      },
      "parameters": {
        "M": 2
      }
    },
    "ota": {
      "circuits": [
        {
          "model": "bias_vbn_diode",
          "name": "vbn_gen",
          "nets": {
            "iref": "iref",
            "vbn": "vbn",
            "vss": "vss"
          },
          "parameters": {
            "M": "${M.bias_diode}"
          }
        },
        {
          "model": "ota_one_stage",
          "name": "stage1",
          "nets": {
            "in_{p,n}": "in_{p,n}",
            "out": "stg1_out",
            "vbn": "vbn",
            "vdd": "vdd",
            "vss": "vss"
          },
          "parameters": {
            "M": {
              "diff": "${M.diff}",
              "load": "${M.load}",
              "tail": "${M.tail}"
            }
          }
        },
        {
          "model": "common_source_amp",
          "name": "stage2",
          "nets": {
            "in": "stg1_out",
            "out": "out",
            "vbn": "vbn",
            "vdd": "vdd",
            "vss": "vss"
          },
          "parameters": {
            "M": "${M.stage2}"
          }
        },
        {
          "model": "capacitor_unit",
          "name": "Cc",
          "nets": {},
          "parameters": {
            "M": "${M.Cc}",
            "p1": "stg1_out",
            "p2": "out"
          }
        },
        {
          "model": null,
          "name": "dummy_devices",
          "nets": {},
          "parameters": {}
        }
      ],
      "name": "ota",
      "nets": {
        "in_{p,n}": "in",
        "iref": "in",
        "out": "out",
        "stg1_out": "internal",
        "vdd": "io",
        "vss": "io"
      },
      "notes": {
        "layout": [
          "symmetric horizontal layout",
          "Deep n-well for the full ota. NTAP guard ring.",
          "Horizontal M4 for VDD and VSS, sizing for < 1ohm resistance",
          "back annotation dummy devices"
        ],
        "sizing": [
          "100uA nominal bias reference current",
          "size stage 1 for noise performance",
          "size stage 2 for load driving and linearity requirements",
          "size miller cap to meet the phase margin specs"
        ],
        "specs": [
          "DC gain: 65dB",
          "GBW: 100MHz",
          "CMRR: 60dB",
          "Offset: 2mV",
          "HD3: -80dBc at 1V p-p output swing",
          "Phase margin: 65 degrees",
          "Power: minimize"
        ]
      },
      "parameters": {
        "Cc": "1pF",
        "M": {
          "bias_diode": 1,
          "diff": 4,
          "load": 4,
          "stage2": 8,
          "tail": 8
        }
      }
    },
    "ota_one_stage": {
      "circuits": [
        {
          "model": "diff_pair_nmos",
          "name": "diff",
          "nets": {
            "in_{p,n}": "in_{p,n}",
            "out_{p,n}": "{n_d, out}",
            "tail": "n_tail"
          },
          "parameters": {
            "M": "${M.diff}"
          }
        },
        {
          "model": "nmos_unit",
          "name": "MN_TAIL",
          "nets": {},
          "parameters": {
            "B": "VSS",
            "D": "n_tail",
            "G": "vbn",
            "M": "${M.tail}",
            "S": "vss"
          }
        },
        {
          "model": "current_mirror_pmos_1_1",
          "name": "load",
          "nets": {
            "out": "out",
            "ref": "n_d",
            "vdd": "vdd"
          },
          "parameters": {
            "M": "${M.load}"
          }
        }
      ],
      "name": "ota_one_stage",
      "nets": {
        "in_{p,n}": "in",
        "n_d": "internal",
        "n_tail": "internal",
        "out": "out",
        "vbn": "in",
        "vdd": "io",
        "vss": "io"
      },
      "notes": {},
      "parameters": {
        "M": {
          "diff": 2,
          "load": 2,
          "tail": 4
        }
      }
    }
  },
  "top_module": "ota",
  "version": "ASDL v1.0"
}